---
title: 'React Hooks 实用技巧'
publishedAt: '2025-01-20'
summary: '分享几个在日常开发中常用的 React Hooks 技巧。'
---

## useCallback 的正确使用时机

很多人会在所有函数上都加 `useCallback`，但这并不总是必要的。

```tsx
// 不需要 useCallback 的场景
function App() {
  const handleClick = () => {
    console.log('clicked')
  }
  return <button onClick={handleClick}>Click</button>
}

// 需要 useCallback 的场景 - 传递给 memo 组件
function App() {
  const handleClick = useCallback(() => {
    console.log('clicked')
  }, [])
  return <MemoizedChild onClick={handleClick} />
}
```

## 自定义 Hook 提取逻辑

当组件中有复杂的状态逻辑时，提取成自定义 Hook 可以提高可读性：

```tsx
function useToggle(initial = false) {
  const [value, setValue] = useState(initial)
  const toggle = useCallback(() => setValue(v => !v), [])
  return [value, toggle] as const
}
```

## useSyncExternalStore

订阅外部数据源时，`useSyncExternalStore` 比 `useEffect` + `useState` 更可靠：

```tsx
const width = useSyncExternalStore(
  (callback) => {
    window.addEventListener('resize', callback)
    return () => window.removeEventListener('resize', callback)
  },
  () => window.innerWidth
)
```

这些技巧在日常开发中非常实用，希望对你有帮助。
